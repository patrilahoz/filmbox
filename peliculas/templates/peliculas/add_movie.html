{% extends "base/base.html" %} 

{% block title %}Añadir película{% endblock %}

<style>
    :root {
        --bg: #191919;
        --panel: #262626;
        --accent: #e9dff0;
        --muted: #bdbdbd;
        --accent: #7c3aed;
        --accent-2: #6d28d9;
        --white: #fafafa;
    }

    * {
        box-sizing: border-box
    }

    html,
    body {
        height: 100%
    }

    body {
        margin: 0;
        font-family: 'Gantari';
        background: var(--bg);
        color: var(--white);
        -webkit-font-smoothing: antialiased;
    }

    h1 {
        font-family: 'Exo 2';
        font-weight: 800;
        font-size: 40px;
        letter-spacing: 1px;
        color: var(--white);
        text-transform: uppercase;
    }

    /* Main card */
    .card-wrap {
        padding: 28px 48px;
    }

    .card {
        background: var(--card);
        padding: 36px;
        border-radius: 15px;
        max-width: 1200px;
        margin: 0 auto;
        box-shadow: 0 0 0 1px rgba(255, 255, 255, 0.01) inset;
    }

    .card h1 {
        margin: 0 0 24px 0;
        font-size: 32px;
        font-weight: 700;
        color: var(--white);
    }

    .content {
        display: flex;
        gap: 48px;
        align-items: flex-start;
    }

    /* Left: image dropzone */
    .thumb-wrap {
        width: 320px;
        height: 440px;
        border: 2px solid rgba(255, 255, 255, 0.08);
        background: #2a2a2a;
        border-radius: 4px;
        position: relative;
        display: flex;
        align-items: center;
        justify-content: center;
        overflow: hidden;
    }

    .thumb-inner {
        width: 100%;
        height: 100%;
        display: flex;
        align-items: center;
        justify-content: center;
        color: var(--muted);
        font-size: 14px;
    }

    .thumb-inner img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        display: block;
    }

    .thumb-overlay {
        position: absolute;
        inset: 12px;
        border: 1px solid rgba(255, 255, 255, 0.15);
        border-radius: 2px;
        pointer-events: none;
    }

    .thumb-actions {
        position: absolute;
        inset: 0;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 0;
        pointer-events: none;
    }

    .upload-btn {
        background: transparent;
        color: var(--muted);
        padding: 0;
        border-radius: 4px;
        cursor: pointer;
        font-size: 13px;
        pointer-events: auto;
        display: inline-flex;
        align-items: center;
        justify-content: center;
    }

    #removeBtn {
        position: absolute;
        bottom: 12px;
        right: 12px;
        display: none;
        background: #D9BDFE;
        color: black;
        border: 2px dashed rgba(255, 255, 255, 0.06);
        padding: 8px 12px;
        border-radius: 4px;
        cursor: pointer;
        pointer-events: auto;
        transition: transform 0.6s ease, background 0.3s ease, box-shadow 0.3s ease;

    }

    #removeBtn:hover {
        background: linear-gradient(100deg, #6E32D5 0%, #6C00FA 100%);
        color: var(--white);
        box-shadow: 0 4px 15px rgba(124, 58, 237, 0.4);
        transform: translateY(-2px) scale(1.05);
        font-weight: 700;
    }

    input[type=file] {
        display: none;
    }

    /* Right: form */
    .form {
        flex: 1;
        display: flex;
        flex-direction: column;
        gap: 18px;
    }

    .row {
        display: flex;
        flex-direction: column;
        gap: 14px;
    }

    .form-group {

        display: flex;
        align-items: flex-start;
        gap: 10px;
    }

    .form-group label {
        width: 160px;
        text-align: left;
        font-family: 'Gantari';
        font-weight: 700;
        font-size: 18px;
        color: var(--white);
        text-transform: uppercase;
        letter-spacing: 0.6px;
        padding-top: 8px;

    }

    .form-group input,
    .form-group textarea {
        flex: 1;
        padding: 12px 14px;
        border-radius: 6px;
        border: 1px solid rgba(255, 255, 255, 0.04);
        background: var(--input);
        color: var(--muted);
        font-size: 14px;
        resize: vertical;
        min-height: 40px;
        font-family: 'Gantari';
    }

    .form-group textarea {
        min-height: 100px;
    }

    .form-group input::placeholder,
    .form-group textarea::placeholder {
        color: #999;
    }

    /* bottom row for button */
    .actions {
        display: flex;
        justify-content: flex-end;
        margin-top: 18px;
    }

    .add-btn {
        background: #6E32D5;
        color: var(--white);
        width: 250px;
        height: 50px;
        padding: 12px 18px;
        border-radius: 8px;
        border: 0;
        font-family: 'Exo 2';
        font-weight: 700;
        font-size: 30px;
        display: inline-flex;
        align-items: center;
        gap: 10px;
        cursor: pointer;
        text-align: center;
        justify-content: center;
        font-size: 20px;
        transition: transform 0.6s ease, background 0.3s ease, box-shadow 0.3s ease;
    }

    .add-btn:hover {
        background: linear-gradient(100deg, #6E32D5 0%, #6C00FA 100%);
        color: var(--white);
        box-shadow: 0 4px 15px rgba(124, 58, 237, 0.4);
        transform: translateY(-2px) scale(1.05);
    }

    .add-btn .hover-icon {
        display: none;
    }






    .plus {
        width: 28px;
        height: 28px;
        border-radius: 6px;
        background: rgba(255, 255, 255, 0.12);
        display: inline-flex;
        align-items: center;
        justify-content: center;
        font-weight: 700;
    }

    @media (max-width:980px) {
        .content {
            flex-direction: column;
            align-items: center
        }

        .thumb-wrap {
            width: 280px;
            height: 380px
        }

        .labels {
            width: 140px
        }
    }
</style>
{% endblock %}

{% block content %}
<main>
    <div class="card-wrap">
        <div class="card">
            <h1>ADD MOVIE</h1>

            <div class="content">
                <!-- Left: image upload / preview -->
                <div class="thumb-wrap" id="thumbWrap">
                    <div class="thumb-inner" id="thumbInner">
                        <!-- empty until image selected -->
                        <span style="color:rgba(255,255,255,0.12)"></span>
                    </div>
                    <div class="thumb-overlay"></div>
                    <div class="thumb-actions">
                        <label id="uploadLabel" class="upload-btn" for="posterInput">
                            <i class="bi bi-plus" aria-hidden style="font-size: 5rem;"></i>
                        </label>
                        <button class="upload-btn" type="button" id="removeBtn" title="Quitar">Quitar</button>
                    </div>
                    <input type="file" id="posterInput" accept="image/*">
                </div>

                <!-- Right: form -->
                <form class="form" id="addMovieForm">
                    <div class="row">
                        <div class="form-group">
                            <label for="title">TITLE</label>
                            <input type="text" id="title" name="title" placeholder="Add Title" required>
                        </div>

                        <div class="form-group">
                            <label for="director">DIRECTOR</label>
                            <input type="text" id="director" name="director" placeholder="Add Director">
                        </div>

                        <div class="form-group">
                            <label for="year">YEAR</label>
                            <input type="text" id="year" name="year" placeholder="Add Year">
                        </div>

                        <div class="form-group">
                            <label for="genres">GENRES</label>
                            <input type="text" id="genres" name="genres" placeholder="Add Genres (comma separated)">
                        </div>

                        <div class="form-group">
                            <label for="cast">CAST</label>
                            <textarea id="cast" name="cast" placeholder="Add Cast"></textarea>
                        </div>

                        <div class="form-group">
                            <label for="synopsis">SYNOPSIS</label>
                            <textarea id="synopsis" name="synopsis" placeholder="Add Synopsis"></textarea>
                        </div>
                    </div>

                    <div class="actions">
                        <button type="submit" class="add-btn">
                            <i class="bi bi-plus me-2" style="font-size: 2rem;"></i>
                            ADD MOVIE
                        </button>

                    </div>
                </form>
            </div>
        </div>
    </div>
</main>



    <script>
        // handle image upload + preview
        const posterInput = document.getElementById('posterInput');
        const thumbInner = document.getElementById('thumbInner');
        const removeBtn = document.getElementById('removeBtn');
        const uploadLabel = document.getElementById('uploadLabel');

        function clearPreview() {
            thumbInner.innerHTML = '';
            thumbInner.style.justifyContent = 'center';
            thumbInner.style.alignItems = 'center';
            // show subtle placeholder (empty)
            // hide the remove button when there's no image
            if (removeBtn) removeBtn.style.display = 'none';
            if (uploadLabel) uploadLabel.style.display = 'inline-flex';
        }

        function showPreview(file) {
            const img = document.createElement('img');
            img.alt = 'Movie Poster';
            const url = URL.createObjectURL(file);
            img.src = url;
            // clear previous
            thumbInner.innerHTML = '';
            thumbInner.appendChild(img);
            // show the remove button when an image is present
            if (removeBtn) removeBtn.style.display = 'inline-block';
            if (uploadLabel) uploadLabel.style.display = 'none';
        }

        posterInput.addEventListener('change', (e) => {
            const file = e.target.files && e.target.files[0];
            if (!file) return clearPreview();
            if (!file.type.startsWith('image/')) { alert('Por favor selecciona una imagen.'); posterInput.value = ''; return; }
            showPreview(file);
        });

        removeBtn.addEventListener('click', () => {
            posterInput.value = '';
            clearPreview();
        });

        // initialize empty preview (no text as requested)
        clearPreview();

        // handle submit
        const form = document.getElementById('addMovieForm');
        form.addEventListener('submit', (ev) => {
            ev.preventDefault();

            const data = new FormData();
            const title = document.getElementById('title').value.trim();
            const director = document.getElementById('director').value.trim();
            const year = document.getElementById('year').value.trim();
            const genres = document.getElementById('genres').value.trim();
            const cast = document.getElementById('cast').value.trim();
            const synopsis = document.getElementById('synopsis').value.trim();

            if (!title) { alert('El título es obligatorio'); return; }

            data.append('title', title);
            data.append('director', director);
            data.append('year', year);
            data.append('genres', genres);
            data.append('cast', cast);
            data.append('synopsis', synopsis);

            if (posterInput.files && posterInput.files[0]) {
                data.append('poster', posterInput.files[0]);
            }

            // Demo: mostrar datos en consola
            console.log('Formulario Add Movie');
            for (const pair of data.entries()) {
                console.log(pair[0], pair[1]);
            }

            // Ejemplo de envío a backend (descomentar y adaptar URL)
            // fetch('/api/movies', { method:'POST', body: data })
            //   .then(r=>r.json())
            //   .then(res=>{ console.log(res); alert('Pelicula añadida') })
            //   .catch(err=>{ console.error(err); alert('Error al añadir') });

            alert('Pelicula preparada para enviar (ver consola).');
            // opcional: form.reset(); clearPreview();
        });
    </script>
</body>


{% endblock %}